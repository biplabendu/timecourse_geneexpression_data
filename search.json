[
  {
    "objectID": "build_plot_gcn.html",
    "href": "build_plot_gcn.html",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "",
    "text": "Show code\nlibrary(dplyr)\nlibrary(dbplyr)\nlibrary(ggplot2)\nfor (i in list.files(here::here(\"R\"), full.names = TRUE)) source(i)\n\n# SAMPLE NAME\n## specify sample name\nsample.names &lt;- c(\"dmel-head\",\"mmus-brain_stem\")\nsample.cycles &lt;- c(\"LD\", \"DD\")\n\n## SPECIFY THE DATASET TO BUILD GCN WITH\nwhich.sample &lt;- sample.names[2]"
  },
  {
    "objectID": "build_plot_gcn.html#user-input-required--",
    "href": "build_plot_gcn.html#user-input-required--",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "USER INPUT REQUIRED —-",
    "text": "USER INPUT REQUIRED —-\nTo create the adjacency matrix, we need to first identify the soft-thresholding power (see WGCNA for more info).\n\n\nShow code\nwriteLines(\"Performing network topology analysis to pick soft-thresholding power\")\n\n\nPerforming network topology analysis to pick soft-thresholding power\n\n\nShow code\n# Choose a set of soft-thresholding powers\npowers = c(c(1:10), seq(from = 12, to=30, by=2))\n# # Call the network topology analysis function\nsft = WGCNA::pickSoftThreshold(datExpr, powerVector = powers, verbose = 5)\n\n\npickSoftThreshold: will use block size 2995.\n pickSoftThreshold: calculating connectivity for given powers...\n   ..working on genes 1 through 2995 of 14935\n   ..working on genes 2996 through 5990 of 14935\n   ..working on genes 5991 through 8985 of 14935\n   ..working on genes 8986 through 11980 of 14935\n   ..working on genes 11981 through 14935 of 14935\n   Power SFT.R.sq  slope truncated.R.sq mean.k. median.k. max.k.\n1      1    0.592  2.080         0.6590  6480.0    6680.0   8920\n2      2    0.225  0.408         0.1580  3860.0    3810.0   6630\n3      3    0.183 -0.183        -0.0269  2630.0    2410.0   5350\n4      4    0.759 -0.452         0.6940  1930.0    1630.0   4510\n5      5    0.895 -0.599         0.8730  1490.0    1140.0   3910\n6      6    0.936 -0.695         0.9250  1190.0     832.0   3450\n7      7    0.945 -0.766         0.9350   973.0     621.0   3090\n8      8    0.946 -0.817         0.9340   814.0     474.0   2800\n9      9    0.948 -0.856         0.9340   691.0     370.0   2550\n10    10    0.947 -0.891         0.9320   595.0     294.0   2340\n11    12    0.944 -0.943         0.9290   454.0     195.0   2010\n12    14    0.944 -0.985         0.9320   358.0     135.0   1750\n13    16    0.933 -1.020         0.9230   290.0      97.4   1550\n14    18    0.934 -1.050         0.9290   239.0      72.3   1380\n15    20    0.925 -1.080         0.9240   200.0      55.2   1240\n16    22    0.924 -1.100         0.9280   170.0      43.1   1130\n17    24    0.917 -1.120         0.9260   146.0      34.2   1030\n18    26    0.917 -1.140         0.9290   127.0      27.6    941\n19    28    0.917 -1.150         0.9330   111.0      22.7    866\n20    30    0.919 -1.170         0.9380    97.5      18.9    801\n\n\nShow code\nwriteLines(\"Plotting the resutls from the network topology analysis\")\n\n\nPlotting the resutls from the network topology analysis\n\n\nShow code\nplot_network_topology(\n  data = sft,\n  height = 0.90\n)\n\n\n\n\n\n\n\n\n\n\nNOTE: The scale-free topology fit index reaches close to 1 (red horizontal line = 0.90) at a soft-thresholding-power == 9.\n\nNow, we can go ahead and create our adjacency matrix by power-transforming the similarity matrix (see WGCNA for more info).\n\n\nShow code\n## Specify the soft-thresholding-power\nsoft.power = 9\n\n# Construct adjacency matrix\n# TO DO: make function ----\nadj_matrix &lt;- WGCNA::adjacency.fromSimilarity(\n  sim_matrix,\n  power = soft.power,\n  type = \"signed\"\n)\n\n## Delete similarity matrix to free up memory\nrm(sim_matrix)\ngc()\n\n\n            used   (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells   6610029  353.1   12765218  681.8   8749321  467.3\nVcells 235671294 1798.1  720171180 5494.5 706352963 5389.1\n\n\n\n\nShow code\n# Convert adj_matrix to matrix\ngene_ids &lt;- rownames(adj_matrix)\n\nadj_matrix &lt;- matrix(adj_matrix, nrow=nrow(adj_matrix))\nrownames(adj_matrix) &lt;- gene_ids\ncolnames(adj_matrix) &lt;- gene_ids\n\nwriteLines(paste0(\"Plotting the power-transformed adjacency matrix for the same \", length(heatmap_indices),\" genes as above\"))\n\n\nPlotting the power-transformed adjacency matrix for the same 200 genes as above\n\n\nShow code\n## Same heatmap as before, but now with the power-transformed adjacency matrix\ngplots::heatmap.2(t(adj_matrix[heatmap_indices, heatmap_indices]),\n                  col=viridis::inferno(100),\n                  labRow=NA, labCol=NA,\n                  trace='none', dendrogram='row',\n                  xlab='Gene', ylab='Gene',\n                  main='Adjacency matrix\\n(power transformed)',\n                  density.info='none', revC=TRUE)"
  },
  {
    "objectID": "contact.html",
    "href": "contact.html",
    "title": "Contact",
    "section": "",
    "text": "Aman Prasanna\n\n\n\nBiplabendu (Billu) Das\nbiplabendu.das@gmail.com\nhttps://biplabendu.github.io/homepage/"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Compare time-course gene expression across species",
    "section": "",
    "text": "This website contain analyses by Aman and Billu for an on-going project that compares time-series gene expression data across species.\nMajority of the data sets used are from the paper by Laloum and Robinson-Rechavi (add reference here)."
  },
  {
    "objectID": "index.html#some-issues",
    "href": "index.html#some-issues",
    "title": "Compare time-course gene expression across species",
    "section": "Some issues:",
    "text": "Some issues:\nNot all of the above Cflo genes are 1:1 orthologs, some likely have paralogs in other species.\n\n\nFor how many ant genes, there are ≥ 2 genes in at least one more species?\n\n\n\nNumber of 1:1 orthlogs between Cflo and other species\n\n\nCflo:other species (orthology)\nNumber of genes\n\n\n\n\n1:1\n2257\n\n\n1:n possible\n368"
  }
]