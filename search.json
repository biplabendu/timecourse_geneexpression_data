[
  {
    "objectID": "build_plot_gcn_compare_tissues.html",
    "href": "build_plot_gcn_compare_tissues.html",
    "title": "Compare time-course gene expression data across tissues",
    "section": "",
    "text": "Show code\nlibrary(dplyr)\nlibrary(dbplyr)\nlibrary(ggplot2)\nfor (i in list.files(here::here(\"R\"), full.names = TRUE)) {\n  source(i)\n}\n\n# SAMPLE NAME\n## specify sample name\nsample.names &lt;- c(\n  # dmel\n  # \"dmel-head\",\n  # \"dmel-body\",\n  # \"dmel-heart\"\n  # # mmus\n  \"mmus-brain_stem\", \n  \"mmus-cerebellum\", \n  \"mmus-hypothalamus\", \n  \"mmus-heart\"\n  # # panu\n  # \"panu-brain_stem\",\n  # \"panu-cerebellum\",\n  # \"panu-hypothalamus\",\n  # \"panu-heart\",\n  # \"panu-scn\"\n)\n# sample.cycles &lt;- c(\"LD\", \"DD\")\n\n## SPECIFY THE DATASET TO BUILD GCN WITH\nwhich.sample &lt;- \"dmel-heart\"\n\nwriteLines(\n  glue::glue(\"Sample: {which.sample}\")\n)\n\n\nSample: dmel-heart\nStructure of input data:"
  },
  {
    "objectID": "build_plot_gcn_compare_tissues.html#make-and-plot-modules",
    "href": "build_plot_gcn_compare_tissues.html#make-and-plot-modules",
    "title": "Compare time-course gene expression data across tissues",
    "section": "Make and plot modules",
    "text": "Make and plot modules\n\n\nShow code\nmods &lt;- purrr::map(\n  sample.names,\n  ~ timecourseRnaseq::make_modules(\n      data = tidydata.db[[.x]],\n      log2 = TRUE,\n      id_column = \"gene_name\",\n      min_expression = NULL,  # automatically estimated\n      min_timepoints = NULL,  # automatically estimated\n      method = \"wgcna\",\n      qc = TRUE,\n      sim_method = \"kendall\",\n      soft_power = 15,      # automatically estimated\n      min_module_size = 50,\n      max_modules = 16,\n      merge_cutoff_similarity = 0.9,\n      plot_network_min_edge = 0.5,\n      plot_network = FALSE,\n      tidy_modules = TRUE\n    )\n) |&gt;\n  setNames(\n    sample.names\n  )\n\n\n---------------------------------------------------\n1. Log2-transform and subset \n---------------------------------------------------\nApplying log2-transformation...Done.\nEstimated min_expression = 8 \nEstimated min_timepoints = 6 \nSubsetting data...Done.\n[ NOTE ]: After subsetting, 8893 of 17406 rows remain.\n\n Flagging genes and samples with too many missing values...\n  ..step 1\nAll okay!Visualizing the log-transformed data\n---------------------------------------------------\n2. Calculate similarity of expression \n---------------------------------------------------\nRunning gene-gene similarity...Done.\n\n\n---------------------------------------------------\n3. Create adjacency matrix \n---------------------------------------------------\nPerforming network topology analysis to pick\n  soft-thresholding power...\n   Power SFT.R.sq   slope truncated.R.sq mean.k. median.k. max.k.\n1      1   0.7240  1.9500          0.654    4510    4900.0   6020\n2      2   0.5090  0.5730          0.389    2970    3230.0   4790\n3      3   0.0298  0.0544          0.363    2170    2280.0   4040\n4      4   0.2950 -0.1720          0.710    1690    1680.0   3510\n5      5   0.6060 -0.3070          0.785    1360    1280.0   3110\n6      6   0.7420 -0.3970          0.817    1130     995.0   2800\n7      7   0.8110 -0.4740          0.818     951     790.0   2540\n8      8   0.8540 -0.5280          0.841     815     634.0   2330\n9      9   0.8860 -0.5790          0.866     708     516.0   2140\n10    10   0.8960 -0.6210          0.868     621     424.0   1980\n11    12   0.9040 -0.6890          0.877     489     294.0   1730\n12    15   0.9040 -0.7770          0.886     359     182.0   1440\n13    18   0.8990 -0.8420          0.895     275     118.0   1220\n14    21   0.8930 -0.8910          0.899     216      80.2   1050\n\nPlotting resutls from the network topology analysis...\n\n\n\n\n\n\n\n\n\nDone.\n[ NOTE, FIGURE ]: Red horizontal line indicates a signed R^2 of 0.9\n\nSetting soft-thresholding power to: 15.\nPower-transforming the gene-gene similarity matrix...Done.\n\n---------------------------------------------------\n4. Convert into topological overlap matrix (dissTOM) \n---------------------------------------------------\nCreating dissTOM...Done.\nPerforming hierarchical clustering on dissTOM...Done.\n\n---------------------------------------------------\n5. Identify modules (clusters) \n---------------------------------------------------\nMerging modules that have a correlation ≥ 0.9 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n  antiquewhite4         bisque4           black            blue           blue2 \n            395              90             279            1931              56 \n         brown2          brown4          coral1          coral2            cyan \n             56              95             747             165             159 \n    darkmagenta darkolivegreen4   darkslateblue   darkturquoise      darkviolet \n            218             166             151             134              56 \n     firebrick4     greenyellow          grey60           ivory      lightcyan1 \n             61             169             145              98              99 \n     lightgreen     lightyellow         magenta          maroon    mediumorchid \n            144             143             346              82             314 \n  mediumpurple2   mediumpurple3    midnightblue    navajowhite2      orangered3 \n             65             190             154              83              68 \n     orangered4   paleturquoise            pink           plum3          purple \n            102             226             180              53             170 \n            red     saddlebrown         skyblue        skyblue1       steelblue \n            188             121             121              70             119 \n       thistle3       turquoise          violet          yellow         yellow4 \n             52             257             113             190              72 \nMerging modules that have a correlation ≥ 0.85 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\nantiquewhite4       bisque4         black          blue         blue2 \n          395           255          1104          3283           128 \n       brown2        coral1   darkmagenta darkslateblue    firebrick4 \n           56          1551           218           151            61 \n  greenyellow        grey60         ivory    lightcyan1    lightgreen \n          288           328            98            99           144 \n  lightyellow        maroon mediumpurple2  midnightblue  navajowhite2 \n          143            82            65           154            83 \n   orangered4         plum3      thistle3 \n          102            53            52 \nMerging modules that have a correlation ≥ 0.8 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\nModule (cluster) size:\nmergedColors\nantiquewhite4       bisque4         black          blue         blue2 \n          796           255          2809          3025           456 \n       brown2   darkmagenta darkslateblue         ivory    lightcyan1 \n           56           608           151            98           164 \n   lightgreen   lightyellow  navajowhite2         plum3      thistle3 \n          144           143            83            53            52 \n\nCutoff used: 0.8 \nNumber of modules identified: 15 \n\nCalculating module-module similarity based\n  on module-eigengene-expression...Done.\nTidying module names...Done.\nPlotting adjacency matrix for module-module similarity...\n\n\n\n\n\n\n\n\n\n---------------------------------------------------\n6. Tidy modules (clusters) \n---------------------------------------------------\n---------------------------------------------------\n1. Log2-transform and subset \n---------------------------------------------------\nApplying log2-transformation...Done.\nEstimated min_expression = 8 \nEstimated min_timepoints = 6 \nSubsetting data...Done.\n[ NOTE ]: After subsetting, 8595 of 17130 rows remain.\n\n Flagging genes and samples with too many missing values...\n  ..step 1\nAll okay!Visualizing the log-transformed data\n---------------------------------------------------\n2. Calculate similarity of expression \n---------------------------------------------------\nRunning gene-gene similarity...Done.\n\n\n---------------------------------------------------\n3. Create adjacency matrix \n---------------------------------------------------\nPerforming network topology analysis to pick\n  soft-thresholding power...\n   Power SFT.R.sq   slope truncated.R.sq mean.k. median.k. max.k.\n1      1  0.74300  2.1000          0.915  3700.0    3770.0   5020\n2      2  0.36800  0.5340          0.756  2170.0    2140.0   3640\n3      3  0.00923 -0.0497          0.550  1450.0    1370.0   2860\n4      4  0.38300 -0.3470          0.698  1040.0     925.0   2350\n5      5  0.68800 -0.5610          0.837   790.0     660.0   1990\n6      6  0.79300 -0.7020          0.880   619.0     487.0   1720\n7      7  0.84200 -0.8060          0.909   498.0     369.0   1510\n8      8  0.86200 -0.8900          0.916   409.0     287.0   1340\n9      9  0.87700 -0.9540          0.924   342.0     228.0   1200\n10    10  0.89000 -1.0000          0.936   290.0     184.0   1080\n11    12  0.91200 -1.0800          0.951   215.0     125.0    898\n12    15  0.91500 -1.1700          0.955   146.0      74.8    705\n13    18  0.91600 -1.2300          0.956   105.0      48.4    571\n14    21  0.92500 -1.2700          0.966    78.6      33.1    474\n\nPlotting resutls from the network topology analysis...\n\n\n\n\n\n\n\n\n\nDone.\n[ NOTE, FIGURE ]: Red horizontal line indicates a signed R^2 of 0.9\n\nSetting soft-thresholding power to: 15.\nPower-transforming the gene-gene similarity matrix...Done.\n\n---------------------------------------------------\n4. Convert into topological overlap matrix (dissTOM) \n---------------------------------------------------\nCreating dissTOM...Done.\nPerforming hierarchical clustering on dissTOM...Done.\n\n---------------------------------------------------\n5. Identify modules (clusters) \n---------------------------------------------------\nMerging modules that have a correlation ≥ 0.9 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n        bisque4           black            blue           brown          brown4 \n             87             737             403             471              88 \n           cyan       darkgreen        darkgrey     darkmagenta  darkolivegreen \n            174             994             132             110             110 \n     darkorange         darkred   darkseagreen4   darkslateblue   darkturquoise \n            128             136              50             236             134 \n    floralwhite           green     greenyellow       honeydew1           ivory \n            192             302             177              53              92 \n lavenderblush3       lightcyan      lightcyan1      lightpink4 lightsteelblue1 \n             57             157              93              57              93 \n    lightyellow          maroon   mediumpurple3    midnightblue    navajowhite2 \n            144              67              93             161              69 \n         orange      orangered4   paleturquoise  palevioletred3            pink \n            129              93             115              70             445 \n          plum1           plum2          purple             red       royalblue \n             94              84             334             380             140 \n    saddlebrown          salmon         salmon4         skyblue       steelblue \n            116             175              71             116             116 \n       thistle2          violet           white \n             81             112             127 \nMerging modules that have a correlation ≥ 0.85 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n          black          brown4            cyan     darkmagenta  darkolivegreen \n           2839              88             846             110             203 \n     darkorange         darkred   darkseagreen4   darkslateblue   darkturquoise \n            128             136              50             236             134 \n          green     greenyellow       honeydew1  lavenderblush3       lightcyan \n            837             177              53              57             157 \n     lightcyan1      lightpink4 lightsteelblue1     lightyellow          maroon \n             93             236              93             144              67 \n   midnightblue    navajowhite2      orangered4  palevioletred3           plum2 \n            161              69              93             186              84 \n            red       royalblue     saddlebrown          salmon         salmon4 \n            380             140             116             175              71 \n      steelblue        thistle2          violet           white \n            116              81             112             127 \nMerging modules that have a correlation ≥ 0.8 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n         brown4       darkgreen     darkmagenta  darkolivegreen      darkorange \n             88            2839             110             203            1435 \n        darkred   darkseagreen4   darkturquoise           green     greenyellow \n            136              50             489             837             413 \n      honeydew1  lavenderblush3       lightcyan      lightcyan1      lightpink4 \n             53              57             157              93             422 \nlightsteelblue1          maroon    midnightblue    navajowhite2      orangered4 \n             93              67             161             256             233 \n    saddlebrown          salmon          violet \n            116             175             112 \nMerging modules that have a correlation ≥ 0.75 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\nModule (cluster) size:\nmergedColors\n         brown4  darkolivegreen      darkorange         darkred   darkseagreen4 \n             88             620             396            3441              50 \n  darkturquoise  lavenderblush3       lightcyan      lightcyan1 lightsteelblue1 \n            489              57             390              93              93 \n         maroon  palevioletred3     saddlebrown          salmon          violet \n             67             422            2102             175             112 \n\nCutoff used: 0.75 \nNumber of modules identified: 15 \n\nCalculating module-module similarity based\n  on module-eigengene-expression...Done.\nTidying module names...Done.\nPlotting adjacency matrix for module-module similarity...\n\n\n\n\n\n\n\n\n\n---------------------------------------------------\n6. Tidy modules (clusters) \n---------------------------------------------------\n---------------------------------------------------\n1. Log2-transform and subset \n---------------------------------------------------\nApplying log2-transformation...Done.\nEstimated min_expression = 8 \nEstimated min_timepoints = 6 \nSubsetting data...Done.\n[ NOTE ]: After subsetting, 8889 of 17453 rows remain.\n\n Flagging genes and samples with too many missing values...\n  ..step 1\nAll okay!Visualizing the log-transformed data\n---------------------------------------------------\n2. Calculate similarity of expression \n---------------------------------------------------\nRunning gene-gene similarity...Done.\n\n\n---------------------------------------------------\n3. Create adjacency matrix \n---------------------------------------------------\nPerforming network topology analysis to pick\n  soft-thresholding power...\n   Power SFT.R.sq   slope truncated.R.sq mean.k. median.k. max.k.\n1      1  0.65100  2.5300          0.937  3640.0    3660.0   4910\n2      2  0.28300  0.6280          0.872  2060.0    2010.0   3420\n3      3  0.00341 -0.0432          0.800  1340.0    1250.0   2620\n4      4  0.27700 -0.3990          0.824   940.0     839.0   2120\n5      5  0.50400 -0.6390          0.833   698.0     593.0   1760\n6      6  0.63600 -0.7980          0.865   538.0     434.0   1500\n7      7  0.70000 -0.9220          0.877   426.0     328.0   1300\n8      8  0.74100 -1.0200          0.886   346.0     254.0   1140\n9      9  0.76300 -1.1000          0.888   285.0     201.0   1010\n10    10  0.78700 -1.1600          0.901   239.0     163.0    909\n11    12  0.81700 -1.2500          0.918   174.0     110.0    743\n12    15  0.84200 -1.3600          0.931   116.0      66.7    572\n13    18  0.82400 -1.4700          0.914    81.5      43.4    456\n14    21  0.84100 -1.5100          0.927    59.9      29.7    372\n\nPlotting resutls from the network topology analysis...\n\n\n\n\n\n\n\n\n\nDone.\n[ NOTE, FIGURE ]: Red horizontal line indicates a signed R^2 of 0.9\n\nSetting soft-thresholding power to: 15.\nPower-transforming the gene-gene similarity matrix...Done.\n\n---------------------------------------------------\n4. Convert into topological overlap matrix (dissTOM) \n---------------------------------------------------\nCreating dissTOM...Done.\nPerforming hierarchical clustering on dissTOM...Done.\n\n---------------------------------------------------\n5. Identify modules (clusters) \n---------------------------------------------------\nMerging modules that have a correlation ≥ 0.9 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n  antiquewhite4         bisque4           black            blue           blue2 \n             74              94             844             299              59 \n          brown          brown2          brown4          coral1          coral2 \n            210              60              95              76              73 \n      darkgreen        darkgrey  darkolivegreen darkolivegreen4      darkorange \n            126             122             110              60             550 \n    darkorange2         darkred   darkslateblue   darkturquoise      darkviolet \n             96             126             411             241              57 \n    floralwhite          grey60       honeydew1      indianred4           ivory \n             96             139              79              62              97 \n lavenderblush3      lightcoral       lightcyan      lightcyan1      lightgreen \n             79              63             139              98             652 \n     lightpink4  lightsteelblue lightsteelblue1         magenta          maroon \n             80              65              99             156              82 \n   mediumorchid   mediumpurple2   mediumpurple3    midnightblue    navajowhite2 \n             73              65              99             145              83 \n         orange      orangered3      orangered4   paleturquoise  palevioletred2 \n            121              65             101             112              52 \n palevioletred3            plum           plum1           plum2          purple \n             84              69             101             160             156 \n            red       royalblue         salmon2         salmon4         skyblue \n            515             128              52              85             119 \n       skyblue1         thistle        thistle1        thistle2        thistle3 \n             71              55              86              89              55 \n         yellow         yellow4     yellowgreen \n            204              71             104 \nMerging modules that have a correlation ≥ 0.85 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n  antiquewhite4         bisque4            blue           blue2           brown \n             74             329             299              59             210 \n         brown2          brown4          coral1          coral2       darkgreen \n             60              95              76              73             191 \n       darkgrey  darkolivegreen darkolivegreen4     darkorange2   darkturquoise \n            330             486              60             748             241 \n     darkviolet          grey60       honeydew1      indianred4           ivory \n           1139             139             239              62              97 \n     lightcoral       lightcyan      lightcyan1      lightpink4  lightsteelblue \n             63             139              98              80              65 \nlightsteelblue1    mediumorchid   mediumpurple3    midnightblue    navajowhite2 \n             99             159              99             145              83 \n         orange      orangered3      orangered4  palevioletred2  palevioletred3 \n            121              65             101              52              84 \n          plum1           plum3       royalblue         salmon2         salmon4 \n            101            1295             128              52              85 \n        skyblue        skyblue1         thistle        thistle2        thistle3 \n            119              71              55              89              55 \n         yellow         yellow4     yellowgreen \n            204              71             104 \nMerging modules that have a correlation ≥ 0.8 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n  antiquewhite4            blue           blue2           brown          brown2 \n             74             976              59             210              60 \n         brown4          coral1          coral2        darkgrey darkolivegreen4 \n            191            1817              73             982              60 \n  darkturquoise          grey60           ivory      lightcoral      lightcyan1 \n            625             139              97             202              98 \n     lightpink4  lightsteelblue lightsteelblue1   mediumpurple3    midnightblue \n             80             238             262              99             264 \n   navajowhite2      orangered4  palevioletred2  palevioletred3         salmon4 \n             83            1589              52              84              85 \n       skyblue1         thistle        thistle2     yellowgreen \n             71              55             160             104 \nMerging modules that have a correlation ≥ 0.75 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n antiquewhite4          blue2          brown         brown2           cyan \n            74             59            283             60           1817 \n     darkgreen       darkgrey  darkturquoise          ivory     lightcoral \n           976           3136            625            359            202 \n    lightcyan1     lightpink4  mediumpurple3   midnightblue   navajowhite2 \n           336             80             99            264             83 \npalevioletred2 palevioletred3        salmon4        thistle       thistle2 \n            52             84             85             55            160 \nMerging modules that have a correlation ≥ 0.7 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\nModule (cluster) size:\nmergedColors\n antiquewhite4          blue2          brown         brown2           cyan \n            74             59            283             60           1817 \n     darkgreen          ivory     lightcoral     lightcyan1     lightpink4 \n          1031            359            202            336            240 \n mediumpurple3   midnightblue   navajowhite2     orangered4 palevioletred2 \n           724            264            168           3136             52 \npalevioletred3 \n            84 \n\nCutoff used: 0.7 \nNumber of modules identified: 16 \n\nCalculating module-module similarity based\n  on module-eigengene-expression...Done.\nTidying module names...Done.\nPlotting adjacency matrix for module-module similarity...\n\n\n\n\n\n\n\n\n\n---------------------------------------------------\n6. Tidy modules (clusters) \n---------------------------------------------------\n---------------------------------------------------\n1. Log2-transform and subset \n---------------------------------------------------\nApplying log2-transformation...Done.\nEstimated min_expression = 7 \nEstimated min_timepoints = 6 \nSubsetting data...Done.\n[ NOTE ]: After subsetting, 9626 of 16619 rows remain.\n\n Flagging genes and samples with too many missing values...\n  ..step 1\nAll okay!Visualizing the log-transformed data\n---------------------------------------------------\n2. Calculate similarity of expression \n---------------------------------------------------\nRunning gene-gene similarity...Done.\n\n\n---------------------------------------------------\n3. Create adjacency matrix \n---------------------------------------------------\nPerforming network topology analysis to pick\n  soft-thresholding power...\n   Power SFT.R.sq  slope truncated.R.sq mean.k. median.k. max.k.\n1      1  0.63000  4.740          0.958  3510.0    3590.0   4390\n2      2  0.36500  1.640          0.914  1810.0    1850.0   2700\n3      3  0.07800  0.483          0.865  1100.0    1100.0   1880\n4      4  0.00597 -0.112          0.839   726.0     719.0   1400\n5      5  0.10400 -0.455          0.846   512.0     495.0   1090\n6      6  0.23800 -0.709          0.860   377.0     356.0    879\n7      7  0.35800 -0.901          0.883   287.0     265.0    724\n8      8  0.45000 -1.040          0.900   225.0     202.0    607\n9      9  0.52800 -1.140          0.924   180.0     158.0    517\n10    10  0.58600 -1.220          0.940   146.0     126.0    446\n11    12  0.66100 -1.400          0.953   101.0      83.0    344\n12    15  0.73200 -1.590          0.971    63.1      48.9    250\n13    18  0.77000 -1.760          0.979    42.3      31.0    192\n14    21  0.78800 -1.910          0.979    29.9      20.8    154\n\nPlotting resutls from the network topology analysis...\n\n\n\n\n\n\n\n\n\nDone.\n[ NOTE, FIGURE ]: Red horizontal line indicates a signed R^2 of 0.9\n\nSetting soft-thresholding power to: 15.\nPower-transforming the gene-gene similarity matrix...Done.\n\n---------------------------------------------------\n4. Convert into topological overlap matrix (dissTOM) \n---------------------------------------------------\nCreating dissTOM...Done.\nPerforming hierarchical clustering on dissTOM...Done.\n\n---------------------------------------------------\n5. Identify modules (clusters) \n---------------------------------------------------\nMerging modules that have a correlation ≥ 0.9 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n  antiquewhite4         bisque4           black            blue           blue2 \n             79              99             183             239              62 \n          brown          brown2          brown4          coral1          coral2 \n            231              62             100              79              78 \n           cyan       darkgreen        darkgrey     darkmagenta  darkolivegreen \n            258             128             124             112             201 \ndarkolivegreen4      darkorange     darkorange2         darkred   darkseagreen3 \n             65             124             100             132              51 \n  darkseagreen4   darkslateblue   darkturquoise      darkviolet      firebrick4 \n             79              97             126              61              67 \n    floralwhite           green     greenyellow          grey60        honeydew \n            103             186             159             253              52 \n      honeydew1      indianred4           ivory  lavenderblush2  lavenderblush3 \n            190              68             105              52              80 \n     lightcoral       lightcyan      lightcyan1      lightgreen      lightpink3 \n             69             150             106             143              54 \n     lightpink4  lightsteelblue     lightyellow         magenta        magenta4 \n             83              70             139             179              54 \n         maroon    mediumorchid   mediumpurple2   mediumpurple3    midnightblue \n             83              76              71             107             151 \n   navajowhite1          orange      orangered3      orangered4   paleturquoise \n             58             214              71             107             119 \n palevioletred2  palevioletred3            pink            plum           plum2 \n             59              89             182              71              96 \n          plum3          purple             red       royalblue     saddlebrown \n             61             162             185             135             120 \n         salmon         salmon2         salmon4         skyblue        skyblue1 \n            153              60              89             122              73 \n       skyblue2        skyblue3       steelblue             tan         thistle \n             76             108             119             154              61 \n       thistle2        thistle3       turquoise          violet           white \n             93              61             369             116             123 \n         yellow         yellow4     yellowgreen \n            216              75             109 \nMerging modules that have a correlation ≥ 0.85 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n  antiquewhite4         bisque4           black            blue           blue2 \n             79             223             397             497              62 \n         brown2          brown4          coral1          coral2       darkgreen \n             62             100              79             249             128 \n    darkmagenta  darkolivegreen darkolivegreen4      darkorange         darkred \n            220             201              65             124             132 \n  darkseagreen3   darkseagreen4   darkslateblue   darkturquoise      darkviolet \n             51              79              97             126              61 \n     firebrick4     floralwhite           green     greenyellow          grey60 \n             67             103             186             298             376 \n       honeydew       honeydew1      indianred4           ivory  lavenderblush2 \n             52             343             143             247              52 \n lavenderblush3       lightcyan      lightcyan1      lightgreen      lightpink3 \n             80             431             106             143              54 \n     lightpink4  lightsteelblue         magenta        magenta4          maroon \n             83              70             779              54              83 \n   mediumorchid   mediumpurple2   mediumpurple3    midnightblue    navajowhite1 \n             76              71             107             212              58 \n     orangered3      orangered4   paleturquoise  palevioletred2  palevioletred3 \n             71             107             119              59              89 \n           pink          purple       royalblue     saddlebrown         salmon2 \n            182             162             135             120              60 \n        salmon4         skyblue        skyblue2       steelblue             tan \n             89             122              76             119             154 \n        thistle        thistle2        thistle3          violet          yellow \n             61              93              61             116             216 \n    yellowgreen \n            109 \nMerging modules that have a correlation ≥ 0.8 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n  antiquewhite4         bisque4           black            blue           blue2 \n            259            1109             397             558              62 \n         brown2          brown4          coral1  darkolivegreen darkolivegreen4 \n             62             100             435             201              65 \n     darkorange     darkorange2         darkred   darkseagreen3   darkseagreen4 \n            124             249             132              51             172 \n  darkslateblue   darkturquoise      firebrick4     floralwhite           green \n             97             126              67             103             186 \n    greenyellow        honeydew      indianred4  lavenderblush3      lightcyan1 \n            476              52             143            1086             179 \n     lightpink3      lightpink4  lightsteelblue        magenta4          maroon \n             54             154              70              54              83 \n   mediumorchid    navajowhite1      orangered3      orangered4   paleturquoise \n             76              58              71             107             119 \n palevioletred3          purple       royalblue     saddlebrown          salmon \n             89             162             351             120             343 \n        salmon2         salmon4         skyblue        skyblue2             tan \n             60              89             122              76             154 \n        thistle        thistle3          violet           white     yellowgreen \n             61              61             116             376             109 \nMerging modules that have a correlation ≥ 0.75 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n          blue2          brown2          brown4       darkgreen  darkolivegreen \n            432              62             100             259            1322 \ndarkolivegreen4      darkorange     darkorange2         darkred   darkseagreen3 \n             65             124             249             132             448 \n  darkseagreen4   darkslateblue   darkturquoise      firebrick4     floralwhite \n            172             167             126              67             103 \n       honeydew      indianred4           ivory  lavenderblush3      lightpink3 \n             52             143             353            1086              54 \n     lightpink4         magenta        magenta4          maroon    mediumorchid \n           1224            1109              54              83              76 \n   navajowhite1      orangered3   paleturquoise  palevioletred3          purple \n             58              71             119             165             162 \n    saddlebrown         salmon2         salmon4         skyblue       steelblue \n            181              60              89             122             476 \n       thistle3 \n             61 \nMerging modules that have a correlation ≥ 0.7 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n          blue2          brown2          brown4       darkgreen darkolivegreen4 \n            432             592             100             259             191 \n     darkorange     darkorange2         darkred   darkseagreen3   darkseagreen4 \n            124             416             132             710             239 \n     darkviolet        honeydew      indianred4           ivory      lightpink3 \n           1121            1161            1229             353              54 \n         maroon    mediumorchid    navajowhite1      orangered3   paleturquoise \n             83              76             239              71             119 \n palevioletred3          purple          salmon         salmon2         salmon4 \n            165             162            1327             182              89 \nMerging modules that have a correlation ≥ 0.65 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n         brown2          brown4       darkgreen darkolivegreen4      darkorange \n            592             152             259             191             124 \n    darkorange2         darkred   darkseagreen3      firebrick4      indianred4 \n           1525             208            1950             239            1229 \n          ivory      lightpink3      lightpink4          maroon    navajowhite1 \n            353              54            1327             515             239 \n     orangered3  palevioletred3          purple         salmon2         salmon4 \n             71             165             162             182              89 \nMerging modules that have a correlation ≥ 0.6 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\nModule (cluster) size:\nmergedColors\n         brown2          brown4       darkgreen darkolivegreen4      darkorange \n            592             152             259             430             124 \n    darkorange2         darkred   darkseagreen3      lightpink3          maroon \n           1525             208            1834              54             515 \n palevioletred3          salmon         salmon2         salmon4 \n           1667            1995             182              89 \n\nCutoff used: 0.6 \nNumber of modules identified: 14 \n\nCalculating module-module similarity based\n  on module-eigengene-expression...Done.\nTidying module names...Done.\nPlotting adjacency matrix for module-module similarity...\n\n\n\n\n\n\n\n\n\n---------------------------------------------------\n6. Tidy modules (clusters) \n---------------------------------------------------\n\n\nShow code\n# mods &lt;- timecourseRnaseq::make_modules(\n#   data = tidydata.db[[which.sample]],\n#   log2 = TRUE,\n#   id_column = \"gene_name\",\n#   min_expression = NULL,  # automatically estimated\n#   min_timepoints = NULL,  # automatically estimated\n#   method = \"wgcna\",\n#   qc = TRUE,\n#   sim_method = \"kendall\",\n#   soft_power = 15,      # automatically estimated\n#   min_module_size = 50,\n#   max_modules = 16,\n#   merge_cutoff_similarity = 0.9,\n#   plot_network_min_edge = 0.5,\n#   plot_network = TRUE,\n#   tidy_modules = TRUE\n#   )"
  },
  {
    "objectID": "build_plot_gcn_compare_tissues.html#modify-network-plot",
    "href": "build_plot_gcn_compare_tissues.html#modify-network-plot",
    "title": "Compare time-course gene expression data across tissues",
    "section": "Modify network plot",
    "text": "Modify network plot\n\nInternal function; use ::: to call\n\n\n\nShow code\ntrash &lt;- purrr::map(\n  sample.names,\n  ~ timecourseRnaseq:::plot_adj_as_network(\n      matrix = mods[[.x]][[\"adj_matrix_ME\"]][[\"ME\"]],\n      # layout = igraph::layout.sugiyama,\n      layout = igraph::layout_in_circle, # changed \n      min_edge = 0.6,\n      node_label_size = 1.2,\n      node_size = 20,\n      edge_size = 3,\n      node_frame_col = \"grey20\",\n      node_fill_col = \"grey80\",\n      vertex.frame.width = 3\n    )\n)\n\n\nVisualizing a simplified representation of the circadian GCN\n\n\n\n\n\n\n\n\n\nVisualizing a simplified representation of the circadian GCN\n\n\n\n\n\n\n\n\n\nVisualizing a simplified representation of the circadian GCN\n\n\n\n\n\n\n\n\n\nVisualizing a simplified representation of the circadian GCN"
  },
  {
    "objectID": "build_plot_gcn_compare_tissues.html#identify-rhythmic-modules",
    "href": "build_plot_gcn_compare_tissues.html#identify-rhythmic-modules",
    "title": "Compare time-course gene expression data across tissues",
    "section": "Identify rhythmic modules",
    "text": "Identify rhythmic modules\n\n\nShow code\ndb_rhy &lt;- purrr::map(\n  sample.names,\n  ~ load_rhy_genes(\n      sample = .x\n    )\n) |&gt; \n  setNames(sample.names)\n\n###-###-###-###-###-###-###-###-\n# Set your p-value of choice\n# col_pval = \"BH.Q\"\ncol_pval = \"default.pvalue\"\n# col_pval = \"raw.pvalue\"\n###-###-###-###-###-###-###-###-\nl_module_genes &lt;- purrr::map(\n  sample.names,\n  ~ module_genes[[.x]] |&gt; \n    arrange(module_identity) |&gt; \n    group_split(module_identity) |&gt; \n    purrr::map(\n      ~ .x |&gt; pull(gene_name)\n    ) |&gt; \n    setNames(unique(module_genes[[.x]]$module_identity))\n) |&gt; \n  setNames(sample.names)\n\nl_rhy_genes &lt;- purrr::map(\n  sample.names,\n  ~ db_rhy[[.x]] |&gt; \n    purrr::map(\n      ~ .x |&gt; \n        filter(\n          if_all(\n            all_of(col_pval),\n            ~ .x &lt; 0.05\n          )\n        ) |&gt; \n        filter(\n          ID %in% unlist(l_module_genes)\n        ) |&gt; \n        pull(1) |&gt; \n        unique()\n    ) |&gt; \n    purrr::compact()\n) |&gt; \n  setNames(sample.names)\n\n\n\nModules vs. Rhythmic genes\n\n\n\nShow code\ntrash &lt;- purrr::map(\n  sample.names,\n  function(x) {\n    writeLines(\"\n    #####################################################\n    How many genes are in each of my geneset of interest?\n    #####################################################\")\n    \n    ## MAKE YOUR LIST OF GENES OF INTEREST ##\n    \n    # LIST ONE - WGCNA modules\n    list1 &lt;- l_module_genes[[x]]\n    sapply(list1, length) |&gt; print()\n    \n    ## LIST TWO - rhythmic genes\n    list2 &lt;- l_rhy_genes[[x]]\n    sapply(list2, length) |&gt; print()\n    \n    ## CHECK FOR OVERLAP\n    # define size of genome\n    size = length(unique(c(unlist(list1), unlist(list2))))\n    # make a GOM object\n    gom.1v2 &lt;- GeneOverlap::newGOM(\n      list2, \n      list1,\n      genome.size = size\n    )\n    GeneOverlap::drawHeatmap(\n      gom.1v2,\n      adj.p = TRUE,\n      cutoff=0.05,\n      what=\"odds.ratio\",\n      # what=\"Jaccard\",\n      log.scale = T,\n      note.col = \"black\",\n      grid.col = \"Oranges\"\n    )\n  }\n)\n\n\n\n    #####################################################\n    How many genes are in each of my geneset of interest?\n    #####################################################\n  C1   C2   C3   C4   C5   C6   C7   C8   C9  C10  C11  C12  C13  C14  C15 \n 456  151   98  164  144  796   56  143 2809  608   83   53  255 3025   52 \n      ARS    empJTK GeneCycle       JTK    meta2d      RAIN \n     1383       482       538       254      1059       870 \n\n\n\n\n\n\n\n\n\n\n    #####################################################\n    How many genes are in each of my geneset of interest?\n    #####################################################\n  C1   C2   C3   C4   C5   C6   C7   C8   C9  C10  C11  C12  C13  C14  C15 \n  88 3441   93  175   57  489  422  390  396 2102  620   67  112   50   93 \n      ARS    empJTK GeneCycle       JTK    meta2d      RAIN \n     3311       872       844       328      2434       781 \n\n\n\n\n\n\n\n\n\n\n    #####################################################\n    How many genes are in each of my geneset of interest?\n    #####################################################\n  C1   C2   C3   C4   C5   C6   C7   C8   C9  C10  C11  C12  C13  C14  C15  C16 \n1817  336 3136  359  202  168   59  283  724   74  240   60   84   52 1031  264 \n      ARS    empJTK GeneCycle       JTK    meta2d      RAIN \n     2535       725       605       299      1655       809 \n\n\n\n\n\n\n\n\n\n\n    #####################################################\n    How many genes are in each of my geneset of interest?\n    #####################################################\n  C1   C2   C3   C4   C5   C6   C7   C8   C9  C10  C11  C12  C13  C14 \n 208 1995 1834  515  259  124 1667  592  182   89   54  152 1525  430 \n      ARS    empJTK GeneCycle       JTK    meta2d      RAIN \n     3319      1281      1039       707      2934      1712"
  },
  {
    "objectID": "build_plot_gcn_oneshot.html",
    "href": "build_plot_gcn_oneshot.html",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "",
    "text": "Show code\nlibrary(dplyr)\nlibrary(dbplyr)\nlibrary(ggplot2)\nfor (i in list.files(here::here(\"R\"), full.names = TRUE)) {\n  source(i)\n}\n\n# SAMPLE NAME\n## specify sample name\nsample.names &lt;- c(\n  # dmel\n  \"dmel-head\",\n  \"dmel-body\",\n  \"dmel-heart\",\n  # mmus\n  \"mmus-brain_stem\", \n  \"mmus-cerebellum\", \n  \"mmus-hypothalamus\", \n  \"mmus-heart\", \n  # panu\n  \"panu-brain_stem\",\n  \"panu-cerebellum\",\n  \"panu-hypothalamus\",\n  \"panu-heart\",\n  \"panu-scn\"\n)\n# sample.cycles &lt;- c(\"LD\", \"DD\")\n\n## SPECIFY THE DATASET TO BUILD GCN WITH\nwhich.sample &lt;- \"panu-scn\"\n\nwriteLines(\n  glue::glue(\"Sample: {which.sample}\")\n)\n\n\nSample: panu-scn\nStructure of input data:"
  },
  {
    "objectID": "build_plot_gcn_oneshot.html#make-and-plot-modules",
    "href": "build_plot_gcn_oneshot.html#make-and-plot-modules",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "Make and plot modules",
    "text": "Make and plot modules\n\n\nShow code\nmods &lt;- timecourseRnaseq::make_modules(\n  data = data.db[[which.sample]],\n  log2 = TRUE,\n  id_column = \"gene_name\",\n  min_expression = NULL,  # automatically estimated\n  min_timepoints = NULL,  # automatically estimated\n  method = \"wgcna\",\n  qc = TRUE,\n  sim_method = \"kendall\",\n  soft_power = NULL,      # automatically estimated\n  min_module_size = 50,\n  max_modules = 16,\n  merge_cutoff_similarity = 0.9,\n  plot_network_min_edge = 0.5,\n  plot_network = FALSE,\n  tidy_modules = TRUE\n  )\n\n\n---------------------------------------------------\n1. Log2-transform and subset \n---------------------------------------------------\nApplying log2-transformation...Done.\nEstimated min_expression = 3 \nEstimated min_timepoints = 8 \nSubsetting data...Done.\n[ NOTE ]: After subsetting, 5186 of 15806 rows remain.\n\n Flagging genes and samples with too many missing values...\n  ..step 1\nAll okay!Visualizing the log-transformed data\n---------------------------------------------------\n2. Calculate similarity of expression \n---------------------------------------------------\nRunning gene-gene similarity...Done.\n\n\n---------------------------------------------------\n3. Create adjacency matrix \n---------------------------------------------------\nPerforming network topology analysis to pick\n  soft-thresholding power...\n   Power SFT.R.sq  slope truncated.R.sq mean.k. median.k. max.k.\n1      1   0.8300  2.660          0.980  2170.0    2210.0   2930\n2      2   0.5320  0.790          0.908  1230.0    1240.0   2060\n3      3   0.0279  0.103          0.716   804.0     790.0   1570\n4      4   0.1700 -0.255          0.691   565.0     539.0   1260\n5      5   0.4450 -0.460          0.777   418.0     384.0   1030\n6      6   0.5980 -0.608          0.835   321.0     283.0    868\n7      7   0.6760 -0.696          0.866   253.0     215.0    741\n8      8   0.7370 -0.773          0.895   204.0     167.0    641\n9      9   0.7770 -0.839          0.913   168.0     131.0    562\n10    10   0.8130 -0.888          0.933   139.0     105.0    496\n11    12   0.8460 -0.973          0.948   100.0      68.1    398\n12    15   0.8700 -1.070          0.966    65.1      38.7    301\n13    18   0.8770 -1.170          0.971    44.9      23.5    240\n14    21   0.8710 -1.250          0.969    32.3      15.0    197\n\nPlotting resutls from the network topology analysis...\n\n\n\n\n\n\n\n\n\nDone.\n[ NOTE, FIGURE ]: Red horizontal line indicates a signed R^2 of 0.9\n\nSetting soft-thresholding power to: 15.\nPower-transforming the gene-gene similarity matrix...Done.\n\n---------------------------------------------------\n4. Convert into topological overlap matrix (dissTOM) \n---------------------------------------------------\nCreating dissTOM...Done.\nPerforming hierarchical clustering on dissTOM...Done.\n\n---------------------------------------------------\n5. Identify modules (clusters) \n---------------------------------------------------\nMerging modules that have a correlation ≥ 0.9 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n          blue          brown           cyan      darkgreen       darkgrey \n           730            294            152            115            113 \n   darkmagenta darkolivegreen     darkorange        darkred  darkturquoise \n            62             74            111            285            114 \n        grey60      lightcyan     lightgreen    lightyellow        magenta \n           130            139            125            120            173 \n        orange  paleturquoise           pink            red      royalblue \n           112             80            678            221            119 \n   saddlebrown         salmon        skyblue      steelblue      turquoise \n            87            160            439             83            391 \n        violet \n            79 \nMerging modules that have a correlation ≥ 0.85 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\n\n\n\n\n\n\n\nModule (cluster) size:\nmergedColors\n         brown           cyan      darkgreen       darkgrey    darkmagenta \n           294            152            234           1126             62 \ndarkolivegreen     darkorange        darkred  darkturquoise         grey60 \n            74            111            285            114            130 \n     lightcyan     lightgreen    lightyellow        magenta         orange \n           243            125            120            173            112 \n paleturquoise            red    saddlebrown      steelblue      turquoise \n            80           1111             87             83            470 \nMerging modules that have a correlation ≥ 0.8 ...Done.\n[ NOTE, FIGURE ] Plotting identified clusters before and after merging.\n\n\nModule (cluster) size:\nmergedColors\n         brown           cyan      darkgreen    darkmagenta darkolivegreen \n           294            235            234             62             74 \n    darkorange  darkturquoise         grey60     lightgreen    lightyellow \n          1222            114            885            125           1489 \n       magenta         orange  paleturquoise    saddlebrown \n           173            112             80             87 \n\nCutoff used: 0.8 \nNumber of modules identified: 14 \n\nCalculating module-module similarity based\n  on module-eigengene-expression...Done.\nTidying module names...Done.\nPlotting adjacency matrix for module-module similarity...\n\n\n\n\n\n\n\n\n\n---------------------------------------------------\n6. Tidy modules (clusters) \n---------------------------------------------------\n\n\nShow code\n# \"Returned object\"\nmods |&gt; str(max.level = 1)\n\n\nList of 4\n $ modules      :List of 2\n $ module_genes : tibble [5,186 × 3] (S3: tbl_df/tbl/data.frame)\n $ adj_matrix   : 'AsIs' num [1:5186, 1:5186] 1.00 6.14e-03 3.44e-09 1.79e-14 1.36e-07 ...\n  ..- attr(*, \"dimnames\")=List of 2\n $ adj_matrix_ME:List of 2"
  },
  {
    "objectID": "build_plot_gcn_oneshot.html#modify-network-plot",
    "href": "build_plot_gcn_oneshot.html#modify-network-plot",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "Modify network plot",
    "text": "Modify network plot\n\nInternal function; use ::: to call\n\n\n\nShow code\ntimecourseRnaseq:::plot_adj_as_network(\n  matrix = mods[[\"adj_matrix_ME\"]][[\"ME\"]],\n  # layout = igraph::layout.sugiyama,\n  layout = igraph::layout_in_circle, # changed \n  min_edge = 0.6,\n  node_label_size = 1.2,\n  node_size = 20,\n  edge_size = 3,\n  node_frame_col = \"grey20\",\n  node_fill_col = \"grey80\",\n  vertex.frame.width = 3\n)\n\n\nVisualizing a simplified representation of the circadian GCN"
  },
  {
    "objectID": "build_plot_gcn_oneshot.html#identify-rhythmic-modules",
    "href": "build_plot_gcn_oneshot.html#identify-rhythmic-modules",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "Identify rhythmic modules",
    "text": "Identify rhythmic modules\n\n\nShow code\ndb_rhy &lt;- load_rhy_genes(\n  sample = which.sample\n)\n###-###-###-###-###-###-###-###-\n# Set your p-value of choice\n# col_pval = \"BH.Q\"\ncol_pval = \"default.pvalue\"\n# col_pval = \"raw.pvalue\"\n###-###-###-###-###-###-###-###-\nl_module_genes &lt;- module_genes |&gt; \n  arrange(module_identity) |&gt; \n  group_split(module_identity) |&gt; \n  purrr::map(\n    ~ .x |&gt; pull(gene_name)\n  ) |&gt; \n  setNames(unique(module_genes[[\"module_identity\"]]))\n\nl_rhy_genes &lt;- db_rhy |&gt; \n  purrr::map(\n    ~ .x |&gt; \n      filter(\n        if_all(\n          all_of(col_pval),\n          ~ .x &lt; 0.05\n        )\n      ) |&gt; \n      filter(\n        ID %in% unlist(l_module_genes)\n      ) |&gt; \n      pull(1) |&gt; \n      unique()\n  ) |&gt; \n  purrr::compact()"
  },
  {
    "objectID": "build_plot_gcn_oneshot.html#comparison",
    "href": "build_plot_gcn_oneshot.html#comparison",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "Comparison",
    "text": "Comparison\n\nModules vs. Rhythmic genes\n\n\n\nShow code\nwriteLines(\"#####################################################\nHow many genes are in each of my geneset of interest?\n#####################################################\")\n\n\n#####################################################\nHow many genes are in each of my geneset of interest?\n#####################################################\n\n\nShow code\n## MAKE YOUR LIST OF GENES OF INTEREST ##\n\n# LIST ONE - WGCNA modules\nlist1 &lt;- l_module_genes\nwriteLines(\"List of interesting genes #1\n----------------------------\nGenes in each of the identified gene-clusters or modules\")\n\n\nList of interesting genes #1\n----------------------------\nGenes in each of the identified gene-clusters or modules\n\n\nShow code\nsapply(list1, length)\n\n\n  C1   C2   C3   C4   C5   C6   C7   C8   C9  C10  C11  C12  C13  C14 \n 114  125  112   74   62  173  235 1489   87  885   80  234  294 1222 \n\n\nShow code\n## LIST TWO - rhythmic genes\nlist2 &lt;- l_rhy_genes\nwriteLines(\"List of interesting genes #2\n----------------------------\nRhythmic genes identified by different algorithms\")\n\n\nList of interesting genes #2\n----------------------------\nRhythmic genes identified by different algorithms\n\n\nShow code\nsapply(list2, length)\n\n\n      ARS    empJTK GeneCycle       JTK        LS    meta2d      RAIN \n      178       328       484       174         1       274       745 \n\n\nShow code\n## CHECK FOR OVERLAP\n# define size of genome\nsize = length(unique(c(unlist(list1), unlist(list2))))\n# make a GOM object\ngom.1v2 &lt;- GeneOverlap::newGOM(\n  list2, \n  list1,\n  genome.size = size\n)\n# png(paste0(path_to_repo, \"/results/figures/\",\n#            \"02_pogo_GCN/\",\n#            sample.name[1],\"_gom_1v2.png\"),\n#     width = 35, height = 15, units = \"cm\", res = 300)\nGeneOverlap::drawHeatmap(\n  gom.1v2,\n  adj.p = TRUE,\n  cutoff=0.05,\n  what=\"odds.ratio\",\n  # what=\"Jaccard\",\n  log.scale = T,\n  note.col = \"black\",\n  grid.col = \"Oranges\"\n)\n\n\n\n\n\n\n\n\n\nShow code\n# trash &lt;- dev.off()\n\n # writeLines(\"How many genes exactly are overlapping between the pairwise comparisons\")\n# getMatrix(gom.1v4, name = \"intersection\") %&gt;% t()\n\nwriteLines(\"Visualizing the significant overlaps between your lists of interesting genes and the identified modules\")\n\n\nVisualizing the significant overlaps between your lists of interesting genes and the identified modules"
  },
  {
    "objectID": "build_plot_gcn_oneshot.html#intramodular-connectivity",
    "href": "build_plot_gcn_oneshot.html#intramodular-connectivity",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "Intramodular connectivity",
    "text": "Intramodular connectivity\n“We begin by calculating the intramodular connectivity for each gene. (In network literature, connectivity is often referred to as”degree”.) The function intramodularConnectivity computes:\n\nthe whole network connectivity kTotal,\nthe within (intra)module connectivity kWithin,\nthe extra-modular connectivity kOut=kTotal-kWithin, and\nthe difference of the intra- and extra-modular connectivities kDiff = kIn - kOut = 2*kIN-kTotal\n\n\n\nShow code\n# From what I can tell, colorh1 in the tutorial refers to moduleColors\ncolorh1 &lt;- mods[[\"modules\"]]$colors\nadj_matrix &lt;- mods[[\"adj_matrix\"]]\n\n# Calculate the connectivities of the genes\nAlldegrees1 = WGCNA::intramodularConnectivity(\n  adjMat = adj_matrix, \n  colors = colorh1\n) |&gt; \n  mutate(\n    gene_name = rownames(adj_matrix),\n    across(\n      matches(\"^k\"),\n      ~ round(.x, 2)\n    )\n  ) |&gt; \n  glimpse()\n\n\nRows: 5,186\nColumns: 5\n$ kTotal    &lt;dbl&gt; 16.15, 39.72, 10.03, 65.04, 28.34, 14.51, 90.39, 27.68, 15.5…\n$ kWithin   &lt;dbl&gt; 5.25, 37.48, 8.05, 59.96, 12.64, 12.34, 86.71, 26.15, 12.28,…\n$ kOut      &lt;dbl&gt; 10.90, 2.24, 1.98, 5.09, 15.70, 2.16, 3.67, 1.53, 3.28, 3.41…\n$ kDiff     &lt;dbl&gt; -5.65, 35.24, 6.07, 54.87, -3.06, 10.18, 83.04, 24.61, 9.00,…\n$ gene_name &lt;chr&gt; \"ENSPANG00000000040\", \"ENSPANG00000000041\", \"ENSPANG00000000…\n\n\nPlotting the mean (± 95% CI) connectivity of genes in different modules\n\n\nShow code\npd &lt;- position_dodge(0.1)\n\n# which_var &lt;- \"kTotal\"\nwhich_var &lt;- c(\"kTotal\", \"kWithin\", \"kOut\", \"kDiff\")\n\nAlldegrees1 |&gt; \n  # rownames_to_column(\"gene_name\") %&gt;% \n  left_join(\n    module_genes, \n    join_by(gene_name)\n  ) |&gt; \n  glimpse() |&gt; \n  # PLOT FROM RAW DATA\n  mutate(\n    module_identity = factor(\n      module_identity, \n      levels = paste0(\n        \"C\",\n        sort(\n          unique(module_genes$module_identity) |&gt; \n            stringr::str_replace(\"C\", \"\") |&gt; \n            as.integer()\n        )\n      ) |&gt; rev()\n    )\n  ) |&gt; \n  summarySE(\n    measurevar = which_var, \n    groupvars = \"module_identity\"\n  ) |&gt; \n  mutate(\n    type = factor(\n      type,\n      levels = which_var\n    )\n  ) |&gt; \n  # Plot\n  ggplot(\n    aes(\n      y = module_identity, \n      x = mean,\n      group = interaction(module_identity, type)\n    )\n  ) +\n  geom_vline(xintercept = 0, col = \"maroon\", alpha = 0.7) +\n  labs(\n    y = \"\",\n    x = glue::glue(\n      \"Connectivity\"\n    ),\n    title = \"\"\n  ) +\n  ## Add error bar here\n  geom_errorbar(\n    aes(xmin = mean-ci, xmax = mean+ci),\n    width = 0.3, \n    position=pd, \n    lwd = 1.3,\n    col=\"black\", \n    alpha = 1\n  ) +\n  # Add the points on top of the error bars\n  geom_point(\n    position = pd, \n    size = 3,\n    col = \"black\", \n    fill = \"orange\",\n    show.legend = F, \n    pch = 21,\n    alpha = 0.9\n  ) +\n  facet_wrap(\n    ~ type,\n    nrow = 2,\n    scales = \"free_x\"\n  ) +\n  scale_x_continuous(\n    n.breaks = 4\n  ) +\n  theme_bw(25) +\n  # scale_color_manual(values=c(\"#F20505\",\"#F5D736\",\"#0FBF67\")) +\n  theme(\n    legend.position = \"none\"\n  )\n\n\nRows: 5,186\nColumns: 7\n$ kTotal          &lt;dbl&gt; 16.15, 39.72, 10.03, 65.04, 28.34, 14.51, 90.39, 27.68…\n$ kWithin         &lt;dbl&gt; 5.25, 37.48, 8.05, 59.96, 12.64, 12.34, 86.71, 26.15, …\n$ kOut            &lt;dbl&gt; 10.90, 2.24, 1.98, 5.09, 15.70, 2.16, 3.67, 1.53, 3.28…\n$ kDiff           &lt;dbl&gt; -5.65, 35.24, 6.07, 54.87, -3.06, 10.18, 83.04, 24.61,…\n$ gene_name       &lt;chr&gt; \"ENSPANG00000000040\", \"ENSPANG00000000041\", \"ENSPANG00…\n$ module_identity &lt;chr&gt; \"C10\", \"C5\", \"C3\", \"C3\", \"C7\", \"C5\", \"C3\", \"C5\", \"C5\",…\n$ old_labels      &lt;chr&gt; \"lightgreen\", \"grey60\", \"lightyellow\", \"lightyellow\", …"
  },
  {
    "objectID": "build_plot_gcn.html",
    "href": "build_plot_gcn.html",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "",
    "text": "Show code\nlibrary(dplyr)\nlibrary(dbplyr)\nlibrary(ggplot2)\nfor (i in list.files(here::here(\"R\"), full.names = TRUE)) {\n  source(i)\n}\n\n# SAMPLE NAME\n## specify sample name\nsample.names &lt;- c(\n  # dmel\n  \"dmel-head\",\n  # mmus\n  \"mmus-brain_stem\", \n  # panu\n  \"panu-hypothalamus\"\n)\n# sample.cycles &lt;- c(\"LD\", \"DD\")\n\n## SPECIFY THE DATASET TO BUILD GCN WITH\nwhich.sample &lt;- sample.names[1]\n\nwriteLines(\n  glue::glue(\"Sample: {which.sample}\")\n)\n\n\nSample: dmel-head"
  },
  {
    "objectID": "build_plot_gcn.html#input-data",
    "href": "build_plot_gcn.html#input-data",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "Input data",
    "text": "Input data\n|gene_name   |  ZT00|  ZT03|  ZT06|  ZT09|  ZT12|  ZT15|  ZT18|  ZT21|\n|:-----------|-----:|-----:|-----:|-----:|-----:|-----:|-----:|-----:|\n|FBgn0000008 | 4.852| 5.215| 4.281| 9.320| 7.119| 2.778| 7.372| 5.757|\n|FBgn0000008 | 4.663| 5.024| 4.115| 8.958| 6.904| 2.769| 7.086| 5.533|\n|FBgn0000014 | 0.039| 0.072| 3.509| 0.000| 0.056| 0.000| 0.016| 0.358|\n|FBgn0000015 | 0.000| 0.015| 4.928| 0.000| 0.000| 0.135| 0.000| 1.598|"
  },
  {
    "objectID": "build_plot_gcn.html#make-and-plot-modules",
    "href": "build_plot_gcn.html#make-and-plot-modules",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "Make and plot modules",
    "text": "Make and plot modules\n\n\nShow code\nmods &lt;- timecourseRnaseq::make_modules(\n  # data = data.db[[which.sample]],\n  data = data.db[[3]],\n  log2 = TRUE,\n  id_column = \"gene_name\",\n  min_expression = NULL,  # automatically estimated\n  min_timepoints = NULL,  # automatically estimated\n  method = \"wgcna\",\n  qc = FALSE,\n  sim_method = \"kendall\",\n  soft_power = NULL,      # automatically estimated\n  min_module_size = 50,\n  max_modules = 15,\n  merge_cutoff_similarity = 0.9,\n  plot_network_min_edge = 0.5,\n  plot_network = TRUE,\n  tidy_modules = FALSE\n  )\n\nmods |&gt; str(max.level = 1)"
  },
  {
    "objectID": "build_plot_gcn.html#modify-network-plot",
    "href": "build_plot_gcn.html#modify-network-plot",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "Modify network plot",
    "text": "Modify network plot\n\n\nShow code\nplot_adj_as_network(\n  matrix = mods[[\"adj_matrix_ME\"]][[\"ME\"]],\n  # layout = igraph::layout.sugiyama,\n  layout = igraph::layout_in_circle, # changed layout\n  min_edge = 0.6,\n  node_label_size = 1.2,\n  node_size = 20,\n  edge_size = 3,\n  node_frame_col = \"grey20\",\n  node_fill_col = \"grey80\",\n  vertex.frame.width = 3\n)"
  },
  {
    "objectID": "build_plot_gcn.html#qc",
    "href": "build_plot_gcn.html#qc",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "QC",
    "text": "QC\n\n\nShow code\ndatExpr %&gt;%\n  check_sample_quality()\n\n\n Flagging genes and samples with too many missing values...\n  ..step 1\nAll okay!\n\n\nShow code\ndatExpr %&gt;% \n  plot_sample_expression()\n\n\nVisualizing the log-transformed data"
  },
  {
    "objectID": "build_plot_gcn.html#qc-1",
    "href": "build_plot_gcn.html#qc-1",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "QC",
    "text": "QC\n\n\nShow code\ncat(\"Before power transformation:\")\n\n\nBefore power transformation:\n\n\nShow code\nplot_sim_matrix(\n  matrix = sim_matrix\n)\n\n\nPlotting a chunk of the gene-gene similarity matrix with 200 genes."
  },
  {
    "objectID": "build_plot_gcn.html#user-input-required--",
    "href": "build_plot_gcn.html#user-input-required--",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "USER INPUT REQUIRED —-",
    "text": "USER INPUT REQUIRED —-\nTo create the adjacency matrix, we need to first identify the soft-thresholding power (see WGCNA for more info).\n\n\nShow code\nsft &lt;- analyze_network_topology(\n  data = datExpr\n)\n\n\nPerforming network topology analysis to pick \n  soft-thresholding power...\n   Power SFT.R.sq    slope truncated.R.sq mean.k. median.k. max.k.\n1      1 0.968000  2.93000          0.959    1650      1730   2060\n2      2 0.951000  1.24000          0.937    1120      1180   1620\n3      3 0.918000  0.65200          0.896     851       879   1360\n4      4 0.878000  0.33300          0.849     683       691   1190\n5      5 0.650000  0.13500          0.578     569       572   1060\n6      6 0.000434 -0.00168         -0.237     486       483    966\n7      7 0.638000 -0.10600          0.549     422       416    887\n8      8 0.775000 -0.19400          0.710     373       364    822\n9      9 0.851000 -0.26000          0.808     333       322    766\n10    10 0.879000 -0.30900          0.846     300       287    718\n11    12 0.882000 -0.39800          0.852     248       230    638\n12    15 0.886000 -0.49000          0.870     195       171    550\n13    18 0.886000 -0.56000          0.888     159       134    483\n14    21 0.883000 -0.62100          0.892     133       106    431\n\nPlotting resutls from the network topology analysis...\n\n\n\n\n\n\n\n\n\nDone.\n[ NOTE, FIGURE ]: Red horizontal line indicates a signed R^2 of 0.9\n\n\n\nNOTE: The scale-free topology fit index reaches close to 1 (red horizontal line) at a soft-thresholding-power of 1.\n\n\n\nShow code\nmy_estimate &lt;- sft$fitIndices |&gt; \n  filter(\n    SFT.R.sq &gt; 0.8 &\n      SFT.R.sq &lt;= 0.9,\n    Power &gt; 6 &\n      Power &lt; 14\n  ) |&gt; \n  arrange(\n    Power\n  ) |&gt; \n  head(1) |&gt; \n  pull(1)\n\n\nNow, we can go ahead and create our adjacency matrix by power-transforming the similarity matrix (see WGCNA for more info).\n\n\nShow code\n## Specify the soft-thresholding-power\nsoft.power = if_else(\n  sft$powerEstimate &lt; 16,\n  max(sft$powerEstimate, my_estimate),\n  my_estimate\n)\n\ncat(\"Selected soft-power:\", soft.power)\n\n\nSelected soft-power: 9\n\n\nShow code\n# Construct adjacency matrix\n# TO DO: make function ----\nadj_matrix &lt;- WGCNA::adjacency.fromSimilarity(\n  sim_matrix,\n  power = soft.power,\n  type = \"signed\"\n) |&gt; \n  as.matrix()\n\ncat(\"After power transformation:\")\n\n\nAfter power transformation:\n\n\nShow code\nplot_sim_matrix(\n  matrix = adj_matrix\n)\n\n\nPlotting a chunk of the gene-gene similarity matrix with 200 genes."
  },
  {
    "objectID": "build_plot_gcn.html#comparison",
    "href": "build_plot_gcn.html#comparison",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "Comparison",
    "text": "Comparison\n\nModules vs. Rhythmic genes\n\n\n\nShow code\nwriteLines(\"#####################################################\nHow many genes are in each of my geneset of interest?\n#####################################################\")\n\n\n#####################################################\nHow many genes are in each of my geneset of interest?\n#####################################################\n\n\nShow code\n## MAKE YOUR LIST OF GENES OF INTEREST ##\n\n# LIST ONE - WGCNA modules\nlist1 &lt;- l_module_genes\nwriteLines(\"List of interesting genes #1\n----------------------------\nGenes in each of the identified gene-clusters or modules\")\n\n\nList of interesting genes #1\n----------------------------\nGenes in each of the identified gene-clusters or modules\n\n\nShow code\nsapply(list1, length)\n\n\n  C1   C2   C3   C4   C5 \n1250  654  503  636  118 \n\n\nShow code\n## LIST TWO - rhythmic genes\nlist2 &lt;- l_rhy_genes\nwriteLines(\"List of interesting genes #2\n----------------------------\nRhythmic genes identified by different algorithms\")\n\n\nList of interesting genes #2\n----------------------------\nRhythmic genes identified by different algorithms\n\n\nShow code\nsapply(list2, length)\n\n\n      ARS    empJTK GeneCycle       JTK    meta2d      RAIN \n      110       289       164        73       115       267 \n\n\nShow code\n## CHECK FOR OVERLAP\n# define size of genome\nsize = length(unique(c(unlist(list1), unlist(list2))))\n# make a GOM object\ngom.1v2 &lt;- GeneOverlap::newGOM(\n  list2, \n  list1,\n  genome.size = size\n)\n# png(paste0(path_to_repo, \"/results/figures/\",\n#            \"02_pogo_GCN/\",\n#            sample.name[1],\"_gom_1v2.png\"),\n#     width = 35, height = 15, units = \"cm\", res = 300)\nGeneOverlap::drawHeatmap(\n  gom.1v2,\n  adj.p = TRUE,\n  cutoff=0.05,\n  what=\"odds.ratio\",\n  # what=\"Jaccard\",\n  log.scale = T,\n  note.col = \"black\",\n  grid.col = \"Oranges\"\n)\n\n\n\n\n\n\n\n\n\nShow code\n# trash &lt;- dev.off()\n\n # writeLines(\"How many genes exactly are overlapping between the pairwise comparisons\")\n# getMatrix(gom.1v4, name = \"intersection\") %&gt;% t()\n\nwriteLines(\"Visualizing the significant overlaps between your lists of interesting genes and the identified modules\")\n\n\nVisualizing the significant overlaps between your lists of interesting genes and the identified modules"
  },
  {
    "objectID": "build_plot_gcn.html#intramodular-connectivity",
    "href": "build_plot_gcn.html#intramodular-connectivity",
    "title": "Build gene co-expression network (GCN) from time-course gene expression data",
    "section": "Intramodular connectivity",
    "text": "Intramodular connectivity\n“We begin by calculating the intramodular connectivity for each gene. (In network literature, connectivity is often referred to as”degree”.) The function intramodularConnectivity computes:\n\nthe whole network connectivity kTotal,\nthe within (intra)module connectivity kWithin,\nthe extra-modular connectivity kOut=kTotal-kWithin, and\nthe difference of the intra- and extra-modular connectivities kDiff = kIn - kOut = 2*kIN-kTotal\n\n\n\nShow code\n# From what I can tell, colorh1 in the tutorial refers to moduleColors\ncolorh1 &lt;- merge$colors\n\n# Calculate the connectivities of the genes\nAlldegrees1 = WGCNA::intramodularConnectivity(\n  adjMat = adj_matrix, \n  colors = colorh1\n) |&gt; \n  tibble::rownames_to_column(\"gene_name\") |&gt;  \n    mutate(\n      across(\n        matches(\"^k\"),\n        ~ round(.x, 2)\n      )\n    )\n\n\nPlotting the mean (± 95% CI) connectivity of genes in different modules\n\n\nShow code\npd &lt;- position_dodge(0.1)\n\n# which_var &lt;- \"kTotal\"\nwhich_var &lt;- c(\"kTotal\", \"kWithin\", \"kOut\", \"kDiff\")\n\nAlldegrees1 |&gt;  \n  # rownames_to_column(\"gene_name\") %&gt;% \n  left_join(\n    module_genes, \n    join_by(gene_name)\n  ) |&gt; \n  # PLOT FROM RAW DATA\n  mutate(\n    module_identity = factor(\n      module_identity, \n      levels = paste0(\n        \"C\",\n        sort(\n          unique(module_genes$module_identity) |&gt; \n            stringr::str_replace(\"C\", \"\") |&gt; \n            as.integer()\n        )\n      ) |&gt; rev()\n    )\n  ) |&gt; \n  summarySE(\n    measurevar = which_var, \n    groupvars = \"module_identity\"\n  ) |&gt; \n  mutate(\n    type = factor(\n      type,\n      levels = which_var\n    )\n  ) |&gt; \n  # Plot\n  ggplot(\n    aes(\n      y = module_identity, \n      x = mean,\n      group = interaction(module_identity, type)\n    )\n  ) +\n  geom_vline(xintercept = 0, col = \"maroon\", alpha = 0.7) +\n  labs(\n    y = \"\",\n    x = glue::glue(\n      \"Connectivity\"\n    ),\n    title = \"\"\n  ) +\n  ## Add error bar here\n  geom_errorbar(\n    aes(xmin = mean-ci, xmax = mean+ci),\n    width = 0.3, \n    position=pd, \n    lwd = 1.3,\n    col=\"black\", \n    alpha = 1\n  ) +\n  # Add the points on top of the error bars\n  geom_point(\n    position = pd, \n    size = 3,\n    col = \"black\", \n    fill = \"orange\",\n    show.legend = F, \n    pch = 21,\n    alpha = 0.9\n  ) +\n  facet_wrap(\n    ~ type,\n    nrow = 2,\n    scales = \"free_x\"\n  ) +\n  scale_x_continuous(\n    n.breaks = 4\n  ) +\n  theme_bw(25) +\n  # scale_color_manual(values=c(\"#F20505\",\"#F5D736\",\"#0FBF67\")) +\n  theme(\n    legend.position = \"none\"\n  )"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Compare time-course gene expression across species",
    "section": "",
    "text": "This website contain analyses by Aman and Billu for an on-going project that compares time-series gene expression data across species.\nMajority of the data sets used are from the paper by Laloum and Robinson-Rechavi (add reference here)."
  },
  {
    "objectID": "index.html#some-issues",
    "href": "index.html#some-issues",
    "title": "Compare time-course gene expression across species",
    "section": "Some issues:",
    "text": "Some issues:\nNot all of the above Cflo genes are 1:1 orthologs, some likely have paralogs in other species.\n\n\nFor how many ant genes, there are ≥ 2 genes in at least one more species?\n\n\n\nNumber of 1:1 orthlogs between Cflo and other species\n\n\nCflo:other species (orthology)\nNumber of genes\n\n\n\n\n1:1\n2257\n\n\n1:n possible\n368"
  },
  {
    "objectID": "contact.html",
    "href": "contact.html",
    "title": "Contact",
    "section": "",
    "text": "Aman Prasanna\n\n\n\nBiplabendu (Billu) Das\nbiplabendu.das@gmail.com\nhttps://biplabendu.github.io/homepage/"
  }
]